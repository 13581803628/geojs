<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: util/throttle.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: util/throttle.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file
 * Based on the following jquery throttle / debounce plugin:
 *
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 *
 * @copyright 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 *
 * The implementation included here is modified to support a callback
 * method that can accumulate values between actual invocations of
 * the throttled method.
 */

(function (window, undefined) {
  'use strict';

  // Internal method reference.
  var _throttle;

  /**
   * Throttle execution of a function. Especially useful for rate limiting
   * execution of handlers on events like resize and scroll. If you want to
   * rate-limit execution of a function to a single time see
   * {@link geo.util.debounce}.
   *
   * In this visualization, | is a throttled-function call and X is the actual
   * callback execution:
   *
   * ::
   *   Throttled with `no_trailing` specified as false or unspecified:
   *   ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
   *   X    X    X    X    X    X        X    X    X    X    X    X
   *
   *   Throttled with `no_trailing` specified as true:
   *   ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
   *   X    X    X    X    X             X    X    X    X    X
   *
   * @function geo.util.throttle
   * @param {number} delay A zero-or-greater delay in milliseconds. For event
   *    callbacks, values around 100 or 250 (or even higher) are most useful.
   * @param {boolean} [no_trailing=false] If no_trailing is
   *    true, callback will only execute every `delay` milliseconds while the
   *    throttled-function is being called. If no_trailing is false or
   *    unspecified, callback will be executed one final time after the last
   *    throttled-function call. (After the throttled-function has not been
   *    called for `delay` milliseconds, the internal counter is reset)
   * @param {function} callback A function to be executed after `delay`
   *    milliseconds. The `this` context and all arguments are passed through,
   *    as-is, to `callback` when the throttled-function is executed.
   * @param {function} [accumulator] A function to be executed (synchronously)
   *    during **each** call to the wrapped function.  Typically, this
   *    this method is used to accumulate values that the callback uses
   *    when it finally executes.
   *
   * @returns {function} The throttled version of `callback`
   *
   * @example
   * var throttled = geo.util.throttle( delay, [ no_trailing, ] callback );
   * $('selector').bind( 'someevent', throttled );
   * $('selector').unbind( 'someevent', throttled );
   */
  geo.util.throttle = function (delay, no_trailing,
                                callback, accumulator, debounce_mode) {
    // After wrapper has stopped being called, this timeout ensures that
    // `callback` is executed at the proper times in `throttle` and `end`
    // debounce modes.
    var timeout_id,

      // Keep track of the last time `callback` was executed.
      last_exec = 0;

    // `no_trailing` defaults to falsy.
    if (typeof no_trailing !== 'boolean') {
      debounce_mode = accumulator;
      accumulator = callback;
      callback = no_trailing;
      no_trailing = undefined;
    }

    // accumulator defaults to no-op
    if (typeof accumulator !== 'function') {
      debounce_mode = accumulator;
      accumulator = function () {};
    }

    // The `wrapper` function encapsulates all of the throttling / debouncing
    // functionality and when executed will limit the rate at which `callback`
    // is executed.
    function wrapper() {
      var that = this, // jshint ignore: line
        elapsed = +new Date() - last_exec,
        args = arguments;

      // Execute `callback` and update the `last_exec` timestamp.
      function exec() {
        last_exec = +new Date();
        callback.apply(that, args);
      }

      // If `debounce_mode` is true (at_begin) this is used to clear the flag
      // to allow future `callback` executions.
      function clear() {
        timeout_id = undefined;
      }

      // always call the accumulator first
      accumulator.apply(that, args);

      if (debounce_mode &amp;&amp; !timeout_id) {
        // Since `wrapper` is being called for the first time and
        // `debounce_mode` is true (at_begin), execute `callback`.
        exec();
      }

      // Clear any existing timeout.
      void(
        timeout_id &amp;&amp; clearTimeout(timeout_id)
      );

      if (debounce_mode === undefined &amp;&amp; elapsed > delay) {
        // In throttle mode, if `delay` time has been exceeded, execute
        // `callback`.
        exec();

      } else if (no_trailing !== true) {
        // In trailing throttle mode, since `delay` time has not been
        // exceeded, schedule `callback` to execute `delay` ms after most
        // recent execution.
        //
        // If `debounce_mode` is true (at_begin), schedule `clear` to execute
        // after `delay` ms.
        //
        // If `debounce_mode` is false (at end), schedule `callback` to
        // execute after `delay` ms.
        timeout_id = setTimeout(
          debounce_mode ?
            clear :
            exec,
          debounce_mode === undefined ?
            delay - elapsed :
            delay
        );
      }
    }

    // Return the wrapper function.
    return wrapper;
  };

  _throttle = geo.util.throttle;

  /**
   * Debounce execution of a function. Debouncing, unlike throttling,
   * guarantees that a function is only executed a single time, either at the
   * very beginning of a series of calls, or at the very end. If you want to
   * simply rate-limit execution of a function, see the &lt;jQuery.throttle>
   * method.
   *
   * In this visualization, | is a debounced-function call and X is the actual
   * callback execution:
   *
   * ::
   *
   *   Debounced with `at_begin` specified as false or unspecified:
   *   ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
   *                            X                                 X
   *
   *   Debounced with `at_begin` specified as true:
   *   ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
   *   X                                 X
   *
   *
   * @param {number} delay A zero-or-greater delay in milliseconds. For event
   *    callbacks, values around 100 or 250 (or even higher) are most useful.
   * @param {boolean} [at_begin=false] If at_begin is false or
   *    unspecified, callback will only be executed `delay` milliseconds after
   *    the last debounced-function call. If at_begin is true, callback will be
   *    executed only at the first debounced-function call. (After the
   *    throttled-function has not been called for `delay` milliseconds, the
   *    internal counter is reset)
   * @param {function} callback A function to be executed after delay milliseconds.
   *    The `this` context and all arguments are passed through, as-is, to
   *    `callback` when the debounced-function is executed.
   * @param {function} [accumulator] A function to be executed (synchronously)
   *    during **each** call to the wrapped function.  Typically, this
   *    this method is used to accumulate values that the callback uses
   *    when it finally executes.
   *
   * @returns {function} A new, debounced, function.
   *
   * @example
   * var debounced = geo.util.debounce( delay, [ at_begin, ] callback );
   * $('selector').bind( 'someevent', debounced );
   * $('selector').unbind( 'someevent', debounced );
   *
   */

  geo.util.debounce = function (delay, at_begin, callback, accumulator) {
    if (typeof at_begin !== 'boolean') {
      accumulator = callback;
      callback = at_begin;
      at_begin = false;
    }
    accumulator = accumulator || function () {};
    return _throttle(delay, false, callback, accumulator, !!at_begin);
  };

})(this);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="geo.camera.html">camera</a></li><li><a href="geo.choroplethFeature.html">choroplethFeature</a></li><li><a href="geo.clock.html">clock</a></li><li><a href="geo.contourFeature.html">contourFeature</a></li><li><a href="geo.d3.d3Renderer.html">d3Renderer</a></li><li><a href="geo.d3.graphFeature.html">graphFeature</a></li><li><a href="geo.d3.lineFeature.html">lineFeature</a></li><li><a href="geo.d3.object.html">object</a></li><li><a href="geo.d3.pathFeature.html">pathFeature</a></li><li><a href="geo.d3.planeFeature.html">planeFeature</a></li><li><a href="geo.d3.pointFeature.html">pointFeature</a></li><li><a href="geo.d3.vectorFeature.html">vectorFeature</a></li><li><a href="geo.ellipsoid.html">ellipsoid</a></li><li><a href="geo.feature.html">feature</a></li><li><a href="geo.featureLayer.html">featureLayer</a></li><li><a href="geo.fetchQueue.html">fetchQueue</a></li><li><a href="geo.fileReader.html">fileReader</a></li><li><a href="geo.geomFeature.html">geomFeature</a></li><li><a href="geo.gl.choroplethFeature.html">choroplethFeature</a></li><li><a href="geo.gl.contourFeature.html">contourFeature</a></li><li><a href="geo.gl.geomFeature.html">geomFeature</a></li><li><a href="geo.gl.lineFeature.html">lineFeature</a></li><li><a href="geo.gl.planeFeature.html">planeFeature</a></li><li><a href="geo.gl.pointFeature.html">pointFeature</a></li><li><a href="geo.gl.polygonFeature.html">polygonFeature</a></li><li><a href="geo.gl.vglRenderer.html">vglRenderer</a></li><li><a href="geo.graphFeature.html">graphFeature</a></li><li><a href="geo.gui.legendWidget.html">legendWidget</a></li><li><a href="geo.gui.sliderWidget.html">sliderWidget</a></li><li><a href="geo.gui.svgWidget.html">svgWidget</a></li><li><a href="geo.gui.uiLayer.html">uiLayer</a></li><li><a href="geo.gui.widget.html">widget</a></li><li><a href="geo.imageTile.html">imageTile</a></li><li><a href="geo.jsonReader.html">jsonReader</a></li><li><a href="geo.layer.html">layer</a></li><li><a href="geo.lineFeature.html">lineFeature</a></li><li><a href="geo.map.html">map</a></li><li><a href="geo.mapInteractor.html">mapInteractor</a></li><li><a href="geo.object.html">object</a></li><li><a href="geo.osmLayer.html">osmLayer</a></li><li><a href="geo.pathFeature.html">pathFeature</a></li><li><a href="geo.planeFeature.html">planeFeature</a></li><li><a href="geo.pointFeature.html">pointFeature</a></li><li><a href="geo.pointSpritesGeomFeature.html">pointSpritesGeomFeature</a></li><li><a href="geo.polygonFeature.html">polygonFeature</a></li><li><a href="geo.renderer.html">renderer</a></li><li><a href="geo.sceneObject.html">sceneObject</a></li><li><a href="geo.tile.html">tile</a></li><li><a href="geo.tileCache.html">tileCache</a></li><li><a href="geo.tileLayer.html">tileLayer</a></li><li><a href="geo.timestamp.html">timestamp</a></li><li><a href="geo.transform.html">transform</a></li><li><a href="geo.util.ClusterGroup.html">ClusterGroup</a></li><li><a href="geo.vectorFeature.html">vectorFeature</a></li><li><a href="jQuery.fn.geojsMap.html">geojsMap</a></li></ul><h3>Namespaces</h3><ul><li><a href="geo.html">geo</a></li><li><a href="geo.d3.html">d3</a></li><li><a href="geo.event.html">event</a></li><li><a href="geo.event.camera.html">camera</a></li><li><a href="geo.event.clock.html">clock</a></li><li><a href="geo.event.feature.html">feature</a></li><li><a href="geo.gl.html">gl</a></li><li><a href="geo.gui.html">gui</a></li><li><a href="geo.util.html">util</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Thu Jan 28 2016 16:54:27 GMT-0500 (EST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
